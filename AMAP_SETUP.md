# 高德地图配置说明

## 概述
本系统的地块管理功能集成了高德地图，用于在地图上绘制地块边界。为了正常使用此功能，需要配置高德地图API Key。

## 配置状态

✅ **API Key已配置完成**
- 当前使用的API Key: `a1144a3e8922b298683254b91aedae13`
- 配置位置: `src/views/plant/land/components/LandDialog.vue`
- 状态: 可以直接使用

## 如需更换API Key

### 1. 申请新的高德地图API Key

1. 访问 [高德开放平台](https://console.amap.com/)
2. 注册/登录账号
3. 创建应用
4. 申请 "Web服务API" 的API Key

### 2. 更新API Key

在 `src/views/plant/land/components/LandDialog.vue` 文件中找到 AMapDrawer 组件，修改 `api-key` 属性：

```vue
<AMapDrawer 
  v-model="formData.landPath"
  :height="350"
  api-key="你的新API_KEY"
  @change="handleBoundaryChange"
/>
```

## 功能说明

### 地块边界绘制
- 在添加/编辑地块时，可以在地图上绘制地块边界
- 点击"开始绘制"按钮，在地图上点击绘制多边形
- 双击完成绘制
- 系统会自动计算地块面积（单位：亩）
- 边界坐标会以JSON格式存储到后端

### 地图操作
- **开始绘制**: 开始在地图上绘制地块边界
- **清除**: 清除当前绘制的边界
- **完成绘制**: 确认当前绘制的边界

### 数据格式
边界坐标以JSON数组格式存储：
```json
[[116.397428, 39.90923], [116.398428, 39.91023], [116.399428, 39.91123]]
```

## 注意事项

1. 确保API Key有效且有足够的调用配额
2. 地块边界至少需要3个点才能形成有效多边形
3. 系统会自动根据绘制的边界计算面积
4. 坐标采用WGS84坐标系（经纬度格式）

## 常见问题

### Q: 地图无法加载
A: 检查API Key是否正确配置，网络是否正常

### Q: 无法绘制边界
A: 确保已点击"开始绘制"按钮，且地图已完全加载

### Q: 面积计算不准确
A: 系统使用简化的面积计算方法，实际面积可能有细微差异

## 技术实现

- 使用 `@amap/amap-jsapi-loader` 加载高德地图
- 支持多边形绘制和编辑
- 自动面积计算
- 响应式设计，支持不同屏幕尺寸
